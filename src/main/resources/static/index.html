<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Inventory</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">

<h1 class="mb-4">Gestão de Inventário</h1>

<div class="card mb-4">
    <div class="card-header">Criar Item</div>
    <div class="card-body">

        <div class="mb-3">
            <label class="form-label">Nome</label>
            <input id="itemName" type="text" class="form-control">
        </div>

        <div class="mb-3">
            <label class="form-label">Stock mínimo</label>
            <input id="minStock" type="number" class="form-control">
        </div>

        <button type="button" class="btn btn-primary" onclick="createItem()">
            Criar
        </button>

    </div>
</div>

<div class="card">
    <div class="card-header">Lista de Itens</div>
    <div class="card-body">
        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Stock Atual</th>
                <th>Stock Mínimo</th>
            </tr>
            </thead>
            <tbody id="itemsTable"></tbody>
        </table>
    </div>
</div>

<script>

    async function loadItems() {
        try {
            const response = await fetch("/api/reports/stock");
            const items = await response.json();

            const tbody = document.getElementById("itemsTable");
            tbody.innerHTML = "";

            items.forEach(item => {
                const row = document.createElement("tr");

                row.innerHTML = `
                <td>${item.itemId}</td>
                <td>${item.itemName}</td>
                <td>${item.currentStock}</td>
                <td>${item.minStock}</td>
            `;

                tbody.appendChild(row);
            });

        } catch (error) {
            console.error("Erro ao carregar itens:", error);
        }
    }

    async function createItem() {

        const name = document.getElementById("itemName").value;
        const minStock = document.getElementById("minStock").value;

        if (!name || !minStock) {
            alert("Preenche todos os campos.");
            return;
        }

        try {
            await fetch("/api/items", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    name: name,
                    minStock: parseInt(minStock)
                })
            });

            document.getElementById("itemName").value = "";
            document.getElementById("minStock").value = "";

            loadItems();

        } catch (error) {
            console.error("Erro ao criar item:", error);
        }
    }

    document.addEventListener("DOMContentLoaded", loadItems);

</script>

</body>
</html>
